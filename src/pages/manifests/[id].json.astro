---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const paths: any[] = [];
  await getCollection('manifests', (j) => {
    console.log('j: ', j.data);
    const path = j.data.id.split('/');
    if (path.length > 0) {
      const id = path[path.length - 1].replace(/\.[^/.]+$/, '');
      console.log('    ID: ', id);
      paths.push({
        params: { id },
        props: { json: j.data },
      });
    } else {
      paths.push({
        params: { id: 'unknown' },
        props: { json: {} },
      });
    }
  });

  return paths;
}

const { json } = Astro.props;
---

<>
  {json && JSON.stringify(json, null, 2)}
</>
